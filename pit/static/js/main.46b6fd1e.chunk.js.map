{"version":3,"sources":["services/MockHeroService.ts","components/Header.tsx","components/Drift_Marker.tsx","components/DriftMarker.tsx","services/MockStoryEncounterService.ts","components/HeroSelector.tsx","components/PartySelection.tsx","components/EncounterDialog.tsx","services/MockMapService.ts","models/MapGraph.ts","services/GraphBuilder.ts","models/Queue.ts","services/MockGameStateService.ts","pages/OverheadMap.tsx","components/StatisticsBlock.tsx","services/MockPartyService.ts","services/MockWorldService.ts","pages/HeroProfile.tsx","pages/EncounterMap.tsx","PitTheme.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["MockHeroService","_heroIds","id","Gyvwain","Balthazar","Gossamer","Justin","Gargamela","this","map","getHeroDetail","heroIds","useStyles","makeStyles","appHeader","backgroundColor","minHeight","display","flexDirection","alignItems","justifyContent","fontSize","color","headerSpan","width","headerParty","position","zIndex","right","top","headerImg","height","border","borderRadius","borderWidth","borderColor","margin","appLogo","pointerEvents","padding","Header","props","classes","useState","party","setParty","useEffect","newParty","getParty","console","error","loadParty","className","src","alt","hero","href","imageUrl","window","exports","Leaflet_module","L","require","Drift_Marker","_slideToUntil","_slideToDuration","_slideToLatLng","_slideFromLatLng","_slideKeepAtCenter","_slideDraggingWasAllowed","_slideFrame","addInitHook","on","slideCancel","slideTo","latlng","options","_map","duration","performance","now","getLatLng","keepAtCenter","undefined","dragging","enabled","disable","doubleClickZoom","touchZoom","scrollWheelZoom","fire","_slideTo","remaining","setLatLng","enable","startPoint","latLngToContainerPoint","endPoint","percentDone","currPoint","multiplyBy","add","currLatLng","containerPointToLatLng","panTo","animate","Util","requestAnimFrame","cancelAnimFrame","Marker","DriftMarker","onMoveEndCallback","el","getOptions","onMoveEnd","moveEnd","contextValue","leaflet","popupContainer","fromProps","toProps","leafletElement","icon","setIcon","zIndexOffset","setZIndexOffset","opacity","setOpacity","draggable","children","value","MapLayer","withLeaflet","MockStoryEncounterService","currentStory","currentId","currentTitle","Story","TheInterceptContent","commonRoomContent","chasmContent","homeContent","nineBellsContent","createEmptyStory","continue","choiceId","ChooseChoiceIndex","canContinue","moveTo","variablesState","GetVariableWithName","detailedEncounter","title","paragraphText","choices","isFinished","finishData","Continue","encounterChoices","currentChoices","c","index","text","container","cursor","heroSelected","HeroSelector","onSelectionChanged","multiSelect","heroes","setHeroes","selected","setSelected","heroService","chooseAll","getAllAvailable","loadHeroes","onSelect","ev","Number","parseInt","currentTarget","newSelected","t","selectedHeroIds","i","push","Grid","imgClass","output","item","xs","Tooltip","name","toString","onClick","renderParty","partyButton","partyButtonDiv","textAlign","PartySelection","setHeroIds","isValid","length","ids","Button","disabled","variant","dialog","background","content","minWidth","fontFamily","actions","EncounterDialog","encChoices","onClose","encounterId","MockEncounterService","encounterService","paragraph","setParagraph","setTitle","setChoices","storyStarted","setStoryStarted","open","handleClose","handleChoice","encounter","chooseChoice","log","handleContinue","startEncounter","Dialog","aria-labelledby","DialogContent","isHeroSwap","indexOf","replace","isHeroSelect","isHeroDismiss","renderParagraph","DialogActions","MockMapService","json","BlackTempleMap","TownMap","vertices","v","latLng","clickRadius","exitId","edges","distance","x","y","latDist","lat","lngDist","lng","Math","sqrt","MapGraph","graph","_graph","getNGraph","getVertices","forEachNode","n","findVertex","nodeId","getNode","findNearestVertex","pos","vertex","data","GraphBuilder","mapData","outGraph","createGraph","addNode","addLink","to","from","weight","Queue","_store","val","shift","MockGameStateService","_state","state","currentMapId","currentVertextId","OverheadMap","useParams","setGraph","setPos","vertexQueue","setEncounterId","mapUrl","setMapUrl","userState","setUserState","initialNode","setInitialNode","handleMoveEnd","marker","vertexId","targetVertex","pop","splits","split","newState","stateService","setState","moveToVertexId","mapGraph","match","newUserState","getState","getMap","Build","initialVertex","loadMap","bounds","LatLngBounds","markerIcon","Icon","iconUrl","iconSize","iconAnchor","Map","crs","CRS","Simple","zoom","minZoom","maxZoom","maxBounds","e","round","path","npath","aStar","find","clear","nextVertex","zoomControl","ImageOverlay","url","StyledTableCell","withStyles","theme","head","palette","common","black","white","body","TableCell","StyledTableRow","root","action","hover","TableRow","table","StatisticsBlock","statistics","createData","base","modifier","total","attributeTotal","attribute","rows","strength","dexterity","constitution","intelligence","wisdom","charisma","TableContainer","component","Paper","Table","aria-label","TableHead","align","TableBody","row","scope","MockPartyService","reputation","traits","MockWorldService","characterGrid","gridTemplateColumns","gridAutoRows","left","sectionHeading","bannerContainer","itemContainer","close","filter","portrait","portraitImg","portraitItem","portraitItemHelm","portraitItemBreastplate","portraitItemGloves","portraitItemLegs","inventory","inventoryGrid","inlineSize","overflowY","gridRowEnd","statisticsBlock","HeroProfile","setHero","world","setWorld","setCurrentId","newHero","newWorld","getWorld","loadHero","attributes","behaviour","renderTrait","EncounterMap","initialPos","PitTheme","createMuiTheme","primary","light","blue","main","dark","secondary","overrides","MuiButton","App","ThemeProvider","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.46b6fd1e.chunk.js","sourcesContent":["import Hero from \"../models/Hero\";\r\n\r\nimport Gossamer from \"./heroes/gossamer.json\";\r\nimport Balthazar from \"./heroes/balthazar_the_unblemished.json\";\r\nimport Gargamela from \"./heroes/gargomela_the_black.json\";\r\nimport Gyvwain from \"./heroes/gyvwain_the_chivalrous.json\";\r\nimport Justin from \"./heroes/justin_the_unwanted.json\";\r\n\r\nexport default class MockHeroService {\r\n    getHeroDetail(id: string): Hero {\r\n        switch (id) {\r\n            case \"Gyvwain the Chivalrous\":\r\n            case \"gyvwain_the_chivalrous\":\r\n                return Gyvwain;\r\n            case \"Balthazar the Unblemished\":\r\n            case \"balthazar_the_unblemished\":\r\n                return Balthazar;\r\n            case \"Gossamer\":\r\n            case \"gossamer\":\r\n                return Gossamer;\r\n            case \"Justin the Unwanted\":\r\n            case \"justin_the_unwanted\":\r\n                return Justin;\r\n            case \"gargomela_the_black\":\r\n            default:\r\n                return Gargamela;\r\n        }\r\n    }\r\n\r\n    private _heroIds: string[] = [\"gyvwain_the_chivalrous\", \"balthazar_the_unblemished\", \"gossamer\", \"gargomela_the_black\"];\r\n\r\n    getParty(): Hero[] {\r\n        const party = this._heroIds.map(id => this.getHeroDetail(id));\r\n        return party;\r\n    }\r\n\r\n    setParty(heroIds: string[]): void {\r\n        this._heroIds = heroIds;\r\n    }\r\n\r\n    getAllAvailable(): Hero[] {\r\n        return [Gyvwain, Balthazar, Gossamer, Gargamela, Justin];\r\n    }\r\n}\r\n","import { makeStyles } from \"@material-ui/core\";\r\nimport { useEffect, useState } from \"react\";\r\nimport Hero from \"../models/Hero\";\r\nimport MockHeroService from \"../services/MockHeroService\";\r\n\r\nconst useStyles = makeStyles({\r\n    appHeader: {\r\n        backgroundColor: \"#282c34\",\r\n        minHeight: \"100px\",\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        alignItems: \"center\",\r\n        justifyContent: \"center\",\r\n        fontSize: \"calc(10px + 2vmin)\",\r\n        color: \"white\",\r\n    },\r\n    headerSpan: {\r\n        width: \"100%\",\r\n        display: \"flex\",\r\n    },\r\n    headerParty: {\r\n        position: \"absolute\",\r\n        zIndex: 1000,\r\n        right: \"10px\",\r\n        top: \"30px\",\r\n    },\r\n    headerImg: {\r\n        width: \"90px\",\r\n        height: \"90px\",\r\n        border: \"solid\",\r\n        borderRadius: \"50%\",\r\n        borderWidth: \"10px\",\r\n        borderColor: \"#282c34\",\r\n        margin: \"4px\",\r\n    },\r\n    appLogo: {\r\n        height: \"70px\",\r\n        pointerEvents: \"none\",\r\n        padding: \"20px\",\r\n    },\r\n});\r\n\r\ntype HeaderProps = {};\r\n\r\nfunction Header(props: HeaderProps) {\r\n    const classes = useStyles();\r\n\r\n    let [party, setParty] = useState(null as Hero[] | null); // The map graph data\r\n\r\n    useEffect(() => {\r\n        // Initial load of party\r\n        const loadParty = () => {\r\n            const heroService = new MockHeroService();\r\n            const newParty = heroService.getParty();\r\n            if (!newParty) {\r\n                console.error(`No party data`);\r\n                return;\r\n            }\r\n\r\n            setParty(newParty);\r\n        };\r\n\r\n        if (party == null) {\r\n            loadParty();\r\n        }\r\n    });\r\n\r\n    const renderParty = () => {\r\n        if (!party) return null;\r\n\r\n        return party.map((hero) => {\r\n            return (\r\n                <a key={hero.id} href={`/#/profile/${hero.id}`}>\r\n                    <img src={hero.imageUrl} className={classes.headerImg} alt=\"profile\" />\r\n                </a>\r\n            );\r\n        });\r\n    };\r\n\r\n    return (\r\n        <header className={classes.appHeader}>\r\n            <span className={classes.headerSpan}>\r\n                <img src=\"./volcano.svg\" className={classes.appLogo} alt=\"logo\" />\r\n                <img className=\"title shadow\" alt=\"Tales from the Pit\" src=\"title.svg\" />\r\n                <span className={classes.headerParty}>{renderParty()}</span>\r\n            </span>\r\n        </header>\r\n    );\r\n}\r\n\r\nexport default Header;\r\n","import { Marker as LeafletMarker, LatLngExpression } from 'leaflet';\r\n\r\nif (typeof window.exports != 'object') {\r\n    //cdn usage on browsers without \"exports\" variable\r\n    window.exports = {}\r\n}\r\n\r\n// constructor type \r\ntype ConstMarker = new (...args: any[]) => LeafletMarker;\r\n// needed leaflet type\r\ntype LeafletType = {\r\n    Marker: ConstMarker,\r\n    Util: any\r\n}\r\ndeclare global {\r\n    interface Window {\r\n        Drift_Marker: any,\r\n        exports: Object,\r\n        L: LeafletType\r\n    }\r\n}\r\n\r\nlet Leaflet_module = window.L ? window.L : require(\"leaflet\") as LeafletType\r\n\r\ntype slideOptions = {\r\n    duration: number\r\n    keepAtCenter?: boolean\r\n}\r\n\r\nclass Drift_Marker extends Leaflet_module.Marker {\r\n\r\n    private _slideToUntil = 0\r\n    private _slideToDuration = 1000\r\n    private _slideToLatLng: LatLngExpression = [0, 0]\r\n    private _slideFromLatLng: LatLngExpression = [0, 0]\r\n    private _slideKeepAtCenter = false\r\n    private _slideDraggingWasAllowed = false\r\n    private _slideFrame = 0\r\n\r\n    addInitHook = () => {\r\n        this.on('move', this.slideCancel, this);\r\n    }\r\n\r\n    // 🍂method slideTo(latlng: LatLng, options: Slide Options): this\r\n    // Moves this marker until `latlng`, like `setLatLng()`, but with a smooth\r\n    // sliding animation. Fires `movestart` and `moveend` events.\r\n    slideTo = (latlng: LatLngExpression, options: slideOptions) => {\r\n        if (!this._map) return;\r\n\r\n        this._slideToDuration = options.duration;\r\n        this._slideToUntil = performance.now() + options.duration;\r\n        this._slideFromLatLng = this.getLatLng();\r\n        this._slideToLatLng = latlng;\r\n        this._slideKeepAtCenter = !!options.keepAtCenter;\r\n        this._slideDraggingWasAllowed =\r\n            this._slideDraggingWasAllowed !== undefined ?\r\n                this._slideDraggingWasAllowed :\r\n                this._map.dragging.enabled();\r\n\r\n        if (this._slideKeepAtCenter) {\r\n            this._map.dragging.disable();\r\n            this._map.doubleClickZoom.disable();\r\n            this._map.options.touchZoom = 'center';\r\n            this._map.options.scrollWheelZoom = 'center';\r\n        }\r\n\r\n        this.fire('movestart');\r\n        this._slideTo();\r\n\r\n        return this;\r\n    }\r\n\r\n    // 🍂method slideCancel(): this\r\n    // Cancels the sliding animation from `slideTo`, if applicable.\r\n    slideCancel() {\r\n        Leaflet_module.Util.cancelAnimFrame(this._slideFrame);\r\n    }\r\n\r\n    private _slideTo = () => {\r\n        if (!this._map) return;\r\n\r\n        var remaining = this._slideToUntil - performance.now();\r\n\r\n        if (remaining < 0) {\r\n            this.setLatLng(this._slideToLatLng);\r\n            this.fire('moveend');\r\n            if (this._slideDraggingWasAllowed) {\r\n                this._map.dragging.enable();\r\n                this._map.doubleClickZoom.enable();\r\n                this._map.options.touchZoom = true;\r\n                this._map.options.scrollWheelZoom = true;\r\n            }\r\n            this._slideDraggingWasAllowed = false;\r\n            return this;\r\n        }\r\n\r\n        var startPoint = this._map.latLngToContainerPoint(this._slideFromLatLng);\r\n        var endPoint = this._map.latLngToContainerPoint(this._slideToLatLng);\r\n        var percentDone = (this._slideToDuration - remaining) / this._slideToDuration;\r\n\r\n        var currPoint = endPoint.multiplyBy(percentDone).add(\r\n            startPoint.multiplyBy(1 - percentDone)\r\n        );\r\n        var currLatLng = this._map.containerPointToLatLng(currPoint)\r\n        this.setLatLng(currLatLng);\r\n\r\n        if (this._slideKeepAtCenter) {\r\n            this._map.panTo(currLatLng, { animate: false })\r\n        }\r\n\r\n        this._slideFrame = Leaflet_module.Util.requestAnimFrame(this._slideTo, this);\r\n    }\r\n\r\n}\r\n\r\nwindow.Drift_Marker = Drift_Marker\r\n\r\nexport default Drift_Marker;\r\n","import React from 'react'\r\nimport Drift_Marker from \"./Drift_Marker\" \r\nimport { Icon, DivIcon, LatLngExpression } from 'leaflet'\r\nimport { LeafletProvider, MapLayer, MapLayerProps, withLeaflet } from 'react-leaflet';\r\n\r\ntype LeafletElement = Drift_Marker\r\n\r\ntype DriftMarkerProps = {\r\n  icon?: Icon | DivIcon,\r\n  draggable?: boolean,\r\n  opacity?: number,\r\n  position: LatLngExpression,\r\n  duration: number,\r\n  keepAtCenter?: boolean,\r\n  zIndexOffset?: number,\r\n  onMoveEnd?: (name: DriftMarker) => void;\r\n} & MapLayerProps\r\n\r\nclass DriftMarker extends MapLayer<DriftMarkerProps, LeafletElement> {\r\n\r\n  private onMoveEndCallback?: (name: DriftMarker) => void;\r\n\r\n  createLeafletElement(props: DriftMarkerProps): LeafletElement {\r\n    const el = new Drift_Marker(props.position, this.getOptions(props));\r\n    this.onMoveEndCallback = props.onMoveEnd;\r\n    el.on('moveend', this.moveEnd);\r\n    this.contextValue = { ...props.leaflet, popupContainer: el }\r\n    return el\r\n  }\r\n\r\n  moveEnd() {\r\n    if (this.onMoveEndCallback) {\r\n      this.onMoveEndCallback(this);\r\n    }\r\n  }\r\n\r\n  updateLeafletElement(fromProps: DriftMarkerProps, toProps: DriftMarkerProps) {\r\n    if (toProps.position !== fromProps.position && typeof toProps.duration == 'number') {\r\n      this.leafletElement.slideTo(toProps.position, {\r\n        duration: toProps.duration,\r\n        keepAtCenter: toProps.keepAtCenter\r\n      })\r\n    }\r\n    if (toProps.icon !== fromProps.icon && toProps.icon) {\r\n      this.leafletElement.setIcon(toProps.icon)\r\n    }\r\n    if (toProps.zIndexOffset !== fromProps.zIndexOffset && toProps.zIndexOffset !== undefined) {\r\n      this.leafletElement.setZIndexOffset(toProps.zIndexOffset)\r\n    }\r\n    if (toProps.opacity !== fromProps.opacity && toProps.opacity !== undefined) {\r\n      this.leafletElement.setOpacity(toProps.opacity)\r\n    }\r\n    if (toProps.draggable !== fromProps.draggable && this.leafletElement.dragging !== undefined) {\r\n      if (toProps.draggable === true) {\r\n        this.leafletElement.dragging.enable()\r\n      } else {\r\n        this.leafletElement.dragging.disable()\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { children } = this.props\r\n\r\n    return children == null || this.contextValue == null ? null : (\r\n      <LeafletProvider value={this.contextValue}>\r\n        {children}\r\n      </LeafletProvider>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withLeaflet<DriftMarkerProps>(DriftMarker);\r\n\r\nexport {};\r\n","import { Choice } from \"inkjs/engine/Choice\";\r\nimport { Story } from \"inkjs/engine/Story\";\r\nimport { StringValue } from \"inkjs/engine/Value\";\r\nimport InkStoryEncounter from \"../models/InkStoryEncounter\";\r\nimport InkStoryChoice from \"../models/InkStoryChoice\";\r\n\r\nimport TheInterceptContent from \"./TheIntercept.json\";\r\nimport commonRoomContent from \"./encounters/common-room.ink.json\";\r\nimport chasmContent from \"./encounters/chasm.ink.json\";\r\nimport homeContent from \"./encounters/home.ink.json\";\r\nimport nineBellsContent from \"./encounters/nine-bells.ink.json\";\r\n\r\n// A mock story service\r\n// Story state will be kept on the server\r\nexport default class MockStoryEncounterService {\r\n    private currentStory: Story | null = null;\r\n    private currentId: string | null = null;\r\n    private currentTitle: string = \"\";\r\n\r\n    public startEncounter(id: string): InkStoryEncounter {\r\n        switch (id) {\r\n            case \"hoard\":\r\n                this.currentTitle = \"Treasure !\";\r\n                this.currentStory = new Story(TheInterceptContent);\r\n                //paragraphText: \"You stumble tired and exhaused into a room stuffed to the ceiling with well-crafted wooden coffers.\",\r\n                break;\r\n            case \"wet-room\":\r\n                this.currentTitle = \"The Intercept !\";\r\n                this.currentStory = new Story(TheInterceptContent);\r\n                break;\r\n            case \"common-room\":\r\n                this.currentTitle = \"Tracking the Yellow-Bellied Crook\";\r\n                this.currentStory = new Story(commonRoomContent);\r\n                break;\r\n            case \"chasm\":\r\n                this.currentTitle = \"Across the Chasm\";\r\n                this.currentStory = new Story(chasmContent);\r\n                break;\r\n            case \"warrens\":\r\n                this.currentTitle = \"Rats !\";\r\n                this.currentStory = new Story(TheInterceptContent);\r\n                break;\r\n            case \"home\":\r\n                this.currentTitle = \"Scupperden\";\r\n                this.currentStory = new Story(homeContent);\r\n                break;\r\n            case \"nine-bells\":\r\n                this.currentTitle = \"The Cathedral\";\r\n                this.currentStory = new Story(nineBellsContent);\r\n                break;\r\n            default:\r\n                return MockStoryEncounterService.createEmptyStory();\r\n        }\r\n        this.currentId = id;\r\n\r\n        return this.continue();\r\n    }\r\n\r\n    public chooseChoice(choiceId: number): InkStoryEncounter {\r\n        if (!this.currentStory || !this.currentId) return MockStoryEncounterService.createEmptyStory();\r\n        this.currentStory.ChooseChoiceIndex(choiceId);\r\n\r\n        return this.continue();\r\n    }\r\n\r\n    public continue(): InkStoryEncounter {\r\n        if (!this.currentStory || !this.currentId) return MockStoryEncounterService.createEmptyStory();\r\n\r\n        if (!this.currentStory.canContinue) {\r\n            const moveTo = this.currentStory.variablesState.GetVariableWithName(\"moveTo\") as StringValue;\r\n            const detailedEncounter = this.currentStory.variablesState.GetVariableWithName(\"detailedEncounter\") as StringValue;\r\n            return {\r\n                id: this.currentId,\r\n                title: this.currentTitle,\r\n                paragraphText: \"\",\r\n                choices: [],\r\n                isFinished: true,\r\n                finishData: {\r\n                    moveTo: moveTo?.value,\r\n                    detailedEncounter: detailedEncounter?.value,\r\n                },\r\n            };\r\n        }\r\n\r\n        const paragraphText = this.currentStory.Continue();\r\n        if (!paragraphText) return MockStoryEncounterService.createEmptyStory();\r\n\r\n        const encounterChoices: InkStoryChoice[] = this.currentStory.currentChoices.map(\r\n            (c: Choice) => {\r\n                return {\r\n                    index: c.index,\r\n                    text: c.text,\r\n                } as InkStoryChoice\r\n            }\r\n        );\r\n\r\n        const encounter: InkStoryEncounter = {\r\n            id: this.currentId,\r\n            title: this.currentTitle,\r\n            paragraphText: paragraphText,\r\n            choices: encounterChoices,\r\n            isFinished: false,\r\n        };\r\n\r\n        return encounter;\r\n    }\r\n\r\n    private static createEmptyStory(): InkStoryEncounter {\r\n        return {\r\n            id: \"\",\r\n            title: \"\",\r\n            paragraphText: \"\",\r\n            choices: [],\r\n            isFinished: true,\r\n        };\r\n    }\r\n}\r\n","import { Grid, makeStyles } from \"@material-ui/core\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport { useEffect, useState } from \"react\";\r\nimport Hero from \"../models/Hero\";\r\nimport MockHeroService from \"../services/MockHeroService\";\r\n\r\nconst useStyles = makeStyles({\r\n    container: {\r\n        position: \"relative\",\r\n        height: \"250px\",\r\n    },\r\n    party: {\r\n        padding: \"30px\",\r\n        position: \"absolute\",\r\n    },\r\n    hero: {\r\n        width: \"70px\",\r\n        height: \"70px\",\r\n        border: \"solid\",\r\n        borderRadius: \"50%\",\r\n        borderWidth: \"10px\",\r\n        borderColor: \"lightgrey\",\r\n        margin: \"4px\",\r\n        cursor: \"pointer\",\r\n    },\r\n    heroSelected: {\r\n        width: \"70px\",\r\n        height: \"70px\",\r\n        border: \"solid\",\r\n        borderRadius: \"50%\",\r\n        borderWidth: \"10px\",\r\n        borderColor: \"mediumaquamarine\",\r\n        margin: \"4px\",\r\n        cursor: \"pointer\",\r\n    },\r\n});\r\n\r\ntype HeroSelectorProps = {\r\n    onSelectionChanged?: (ids: string[]) => void;\r\n    // encounterId: string | null;\r\n    chooseAll?: boolean;\r\n    multiSelect?: boolean;\r\n};\r\n\r\nfunction HeroSelector(props: HeroSelectorProps) {\r\n    const classes = useStyles();\r\n    const onSelectionChanged = props.onSelectionChanged;\r\n    const multiSelect = props.multiSelect;\r\n\r\n    let [heroes, setHeroes] = useState(null as Hero[] | null); // The map graph data\r\n    let [selected, setSelected] = useState([] as boolean[]);\r\n\r\n    useEffect(() => {\r\n        // Initial load of party\r\n        const loadHeroes = () => {\r\n            const heroService = new MockHeroService();\r\n            const newParty = props.chooseAll ? heroService.getAllAvailable() : heroService.getParty();\r\n            if (!newParty) {\r\n                console.error(`No party data`);\r\n                return;\r\n            }\r\n\r\n            setHeroes(newParty);\r\n        };\r\n\r\n        if (heroes == null) {\r\n            loadHeroes();\r\n        }\r\n    });\r\n\r\n    const onSelect = (ev: React.MouseEvent<HTMLImageElement, MouseEvent>) => {\r\n        const id = Number.parseInt(ev.currentTarget.id);\r\n\r\n        const newSelected = multiSelect ? selected.map((t) => t) : [];\r\n        \r\n        newSelected[id] = !newSelected[id];\r\n        setSelected(newSelected);\r\n\r\n        if (!heroes) return;\r\n\r\n        const selectedHeroIds: string[] = [];\r\n        for (let i = 0; i < 8; i++) {\r\n            if (newSelected[i]) selectedHeroIds.push(heroes[i].id);\r\n        }\r\n\r\n        if (onSelectionChanged) onSelectionChanged(selectedHeroIds);\r\n    };\r\n\r\n    const renderParty = () => {\r\n        if (!heroes) return null;\r\n\r\n        let index = 0;\r\n\r\n        return heroes.map((hero) => {\r\n            const imgClass = selected[index] ? `${classes.heroSelected}` : `${classes.hero}`;\r\n            const output = (\r\n                <Grid item xs={3}>\r\n                    <Tooltip title={hero.name} key={index}>\r\n                        <img src={hero.imageUrl} id={index.toString()} onClick={onSelect} className={imgClass} alt=\"profile\" />\r\n                    </Tooltip>\r\n                </Grid>\r\n            );\r\n            index++;\r\n            return output;\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div className={classes.container}>\r\n            <div className={classes.party}>\r\n                <Grid container>{renderParty()}</Grid>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default HeroSelector;\r\n","import React, { useState } from \"react\";\r\nimport { Button, makeStyles, Tooltip } from \"@material-ui/core\";\r\n\r\nimport HeroSelector from \"./HeroSelector\";\r\nimport MockHeroService from \"../services/MockHeroService\";\r\n\r\nconst useStyles = makeStyles({\r\n    partyButton: {\r\n        //margin: \"auto 10px\",\r\n    },\r\n    partyButtonDiv: {\r\n        width: \"100%\",\r\n        textAlign: \"center\",\r\n    }\r\n});\r\n\r\nfunction PartySelection() {\r\n    const classes = useStyles();\r\n\r\n    // let [isValid, setIsValid] = useState(false);\r\n    let [heroIds, setHeroIds] = useState([] as string[]);\r\n\r\n    const selectionChanged = (ids: string[]) => {\r\n\r\n        setHeroIds(ids);\r\n    };\r\n\r\n    const isValid = () => heroIds.length === 4; \r\n\r\n    const changeParty = (ev: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\r\n        if (!isValid()) return;\r\n\r\n        const service = new MockHeroService();\r\n        service.setParty(heroIds);\r\n        // TODO: How to trigger a header reload?\r\n        // TODO: Maybe a shared callback?\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <HeroSelector onSelectionChanged={selectionChanged} chooseAll={true} />\r\n            {/* TODO: Tooltip not working when button disabled? */}\r\n            <Tooltip title={isValid() ? \"Apply party changes\" : \"Please select four heroes\"}>\r\n                <div className={classes.partyButtonDiv}>\r\n                    <Button className={classes.partyButton} onClick={changeParty} disabled={!isValid()} variant=\"contained\" color=\"primary\">\r\n                        Apply\r\n                    </Button>\r\n                </div>\r\n            </Tooltip>\r\n        </div>\r\n    ); \r\n}\r\n\r\nexport default PartySelection;\r\n","import React, { useEffect, useState } from \"react\";\r\n\r\nimport { Dialog, makeStyles } from \"@material-ui/core\";\r\n\r\nimport MockEncounterService from \"../services/MockStoryEncounterService\";\r\nimport { Button, DialogActions, DialogContent } from \"@material-ui/core\";\r\nimport InkStoryChoice from \"../models/InkStoryChoice\";\r\nimport PartySelection from \"./PartySelection\";\r\nimport HeroSelector from \"./HeroSelector\";\r\n\r\nconst useStyles = makeStyles({\r\n    dialog: {\r\n        // backgroundImage: \"url(images/scroll.png)\"\r\n    },\r\n    background: {\r\n        position: \"absolute\",\r\n        opacity: 0.1,\r\n        right: \"20px\",\r\n    },\r\n    content: {\r\n        minWidth: \"520px\",\r\n        minHeight: \"460px\",\r\n        padding: \"40px\",\r\n        fontFamily: \"Martel\",\r\n    },\r\n    actions: {\r\n        padding: \"30px\",\r\n        //paddingBottom: \"100px\",\r\n        //paddingRight: \"80px\",\r\n    },\r\n});\r\n\r\ntype EncounterDialogProps = {\r\n    onClose: (moveTo?: string) => void;\r\n    encounterId: string | null;\r\n};\r\n\r\nfunction EncounterDialog(props: EncounterDialogProps) {\r\n    const { onClose, encounterId } = props;\r\n\r\n    const [encounterService] = useState(new MockEncounterService());\r\n    let [paragraph, setParagraph] = useState(\"\");\r\n    let [title, setTitle] = useState(\"\");\r\n    let [choices, setChoices] = useState([] as InkStoryChoice[]);\r\n    let [storyStarted, setStoryStarted] = useState(false);\r\n\r\n    const open: boolean = encounterId !== null;\r\n    const classes = useStyles();\r\n\r\n    const handleClose = () => {\r\n        setStoryStarted(false);\r\n        onClose();\r\n    };\r\n\r\n    const handleCloseWithValue = (moveTo: string) => {\r\n        setStoryStarted(false);\r\n        onClose(moveTo);\r\n    };\r\n\r\n    const handleChoice = (ev: any) => {\r\n        const choiceId = Number.parseInt(ev.currentTarget.id);\r\n\r\n        // Tell the story where to go next\r\n        const encounter = encounterService.chooseChoice(choiceId);\r\n\r\n        if (!encounter.isFinished) {\r\n            console.log(`Selected ${choiceId} for ${encounter.id}`);\r\n\r\n            setParagraph(encounter.paragraphText);\r\n            setTitle(encounter.title);\r\n            setChoices(encounter.choices);\r\n        }\r\n        else {\r\n            // Finish the story\r\n            handleClose();\r\n        }\r\n    };\r\n\r\n    const handleContinue = (ev: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\r\n        const encounter = encounterService.continue();\r\n\r\n        if (!encounter.isFinished) {\r\n            setParagraph(encounter.paragraphText);\r\n            setChoices(encounter.choices);\r\n        } else {\r\n            // Finished -> Check variables\r\n            if (encounter.finishData) {\r\n                const moveTo = encounter.finishData.moveTo;\r\n                if (moveTo) {\r\n                    handleCloseWithValue(moveTo);\r\n                    return;\r\n                }\r\n            }\r\n            handleClose();\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        // Initial load of encounter data\r\n        const startEncounter = () => {\r\n            if (!encounterId) return;\r\n\r\n            console.log(`Loading encounter ${encounterId}`);\r\n\r\n            setStoryStarted(true);\r\n\r\n            const encounter = encounterService.startEncounter(encounterId);\r\n            if (encounter.isFinished) {\r\n                console.error(`No encounter data for ${encounterId}`);\r\n                return;\r\n            }\r\n            console.log(`Started ${encounter.id} encounter`);\r\n            setParagraph(encounter.paragraphText);\r\n            setTitle(encounter.title);\r\n            setChoices(encounter.choices);\r\n        };\r\n\r\n        // console.log(`useEffect2 ${encounterId} open=${open} storyStarted=${storyStarted}`);\r\n\r\n        if (open && !storyStarted) {\r\n            startEncounter();\r\n        }\r\n    }, [encounterId]);\r\n\r\n    const renderChoices = (encChoices: InkStoryChoice[]) => {\r\n        if (encChoices.length === 0) {\r\n            return <Button onClick={handleContinue}>Continue</Button>;\r\n        }\r\n\r\n        return encChoices.map((c: InkStoryChoice) => (\r\n            <Button id={c.index.toString()} key={c.index} onClick={handleChoice}>\r\n                {c.text}\r\n            </Button>\r\n        ));\r\n    };\r\n\r\n    const renderParagraph = (text: string) => {\r\n\r\n        let paragraphText = text;\r\n\r\n        const isHeroSwap = text.indexOf(\"[HeroSwap]\") >= 0;\r\n        if (isHeroSwap) {\r\n            paragraphText = paragraphText.replace(\"[HeroSwap]\", \"\");\r\n        }\r\n        const isHeroSelect = text.indexOf(\"[HeroSelect]\") >= 0;\r\n        if (isHeroSelect) {\r\n            paragraphText = paragraphText.replace(\"[HeroSelect]\", \"\");\r\n        }\r\n        const isHeroDismiss = text.indexOf(\"[HeroDismiss]\") >= 0;\r\n        if (isHeroDismiss) {\r\n            paragraphText = paragraphText.replace(\"[HeroDismiss]\", \"\");\r\n        }\r\n\r\n        return (\r\n            <div>\r\n                <p>{paragraphText}</p>\r\n                {isHeroSwap ? <PartySelection /> : null}\r\n                {isHeroSelect ? <HeroSelector /> : null}\r\n                {isHeroDismiss ? <HeroSelector /> : null}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        // className={classes.dialog}\r\n        <Dialog\r\n            className={classes.dialog}\r\n            onClose={handleClose}\r\n            aria-labelledby=\"simple-dialog-title\"\r\n            open={open}\r\n            //disableBackdropClick={true}\r\n        >\r\n            {/* <DialogTitle id=\"simple-dialog-title\">Set backup account</DialogTitle> */}\r\n            <DialogContent className={classes.content}>\r\n                <img className={classes.background} alt=\"\" src=\"./images/chest.jpg\" />\r\n                <h1>{title}</h1>\r\n                {renderParagraph(paragraph)}\r\n            </DialogContent>\r\n            <DialogActions className={classes.actions}>{renderChoices(choices)}</DialogActions>\r\n        </Dialog>\r\n    );\r\n}\r\n\r\nexport default EncounterDialog;\r\n","import { latLng } from \"leaflet\";\r\n\r\nimport MapData from \"../models/MapData\";\r\nimport MapVertex from \"../models/MapVertex\";\r\nimport IMapService from \"./IMapService\";\r\n\r\nimport BlackTempleMap from \"./maps/blacktemple.json\";\r\nimport TownMap from \"./maps/town.json\";\r\n\r\nexport default class MockMapService implements IMapService {\r\n    public getMap(id: string): MapData | null {\r\n\r\n        let json: any = null;\r\n\r\n        switch (id) {\r\n            case \"black_temple\":\r\n                json = BlackTempleMap;\r\n                break;\r\n            case \"town\":\r\n                json = TownMap;\r\n                break;\r\n            default:\r\n                json = BlackTempleMap;\r\n                break;\r\n        }\r\n        \r\n        const map = {\r\n            id: json.id,\r\n            imageUrl: json.imageUrl,\r\n            vertices: json.vertices.map(\r\n                (v: any) => {\r\n                    return {\r\n                        id: v.id,\r\n                        position: latLng(v.position[0], v.position[1]),\r\n                        clickRadius: v.clickRadius,\r\n                        encounterId: v.encounterId,\r\n                        exitId: v.exitId,\r\n                    } as MapVertex;\r\n                }\r\n            ),\r\n            edges: json.edges,\r\n        } as MapData;\r\n\r\n        return map;\r\n    }\r\n}\r\n","import { LatLng } from \"leaflet\";\r\nimport { Graph, Node } from \"ngraph.graph\";\r\n\r\n// Calculates the distance between two points\r\nexport const distance = (x: LatLng, y: LatLng): number => {\r\n    const latDist = x.lat - y.lat;\r\n    const lngDist = x.lng - y.lng;\r\n    return Math.sqrt(latDist * latDist + lngDist * lngDist);\r\n};\r\n\r\nexport class MapGraph {\r\n    constructor(graph: Graph<NodeData, VertexData>) {\r\n        this._graph = graph;\r\n    }\r\n\r\n    private _graph: Graph<NodeData, VertexData>;\r\n\r\n    public getNGraph = (): Graph<NodeData, VertexData> => this._graph;\r\n\r\n    // Build verticies from the graph\r\n    // TODO: Is there an easier method to use?\r\n    public getVertices = (): Node<NodeData>[] => {\r\n        var vertices: Node<NodeData>[] = [];\r\n        this._graph.forEachNode((n: Node<NodeData>) => {\r\n            vertices.push(n);\r\n        });\r\n\r\n        return vertices;\r\n    };\r\n\r\n    public findVertex = (nodeId: string): Node<NodeData> | undefined => this._graph?.getNode(nodeId);\r\n\r\n    // Get the vertex nearest to the clicked point\r\n    public findNearestVertex = (pos: LatLng): any => {\r\n        const vertices = this.getVertices();\r\n\r\n        for (let i = 0; i < vertices.length; i++) {\r\n            const vertex = vertices[i];\r\n\r\n            const dist = distance(pos, vertex.data.position);\r\n            const isInRadius = dist < vertex.data.clickRadius;\r\n\r\n            if (isInRadius) {\r\n                console.log(\"match\");\r\n                return vertex;\r\n            }\r\n            // console.log(`Distance to ${vertex.id} is (${dist} < ${vertex.data.clickRadius}) = ${isInRadius}`);\r\n        }\r\n\r\n        return null;\r\n    };\r\n}\r\n\r\nexport interface NodeData {\r\n    position: LatLng;\r\n    clickRadius: number;\r\n    encounterId?: string;\r\n    exitId?: string;\r\n}\r\n\r\nexport interface VertexData {\r\n    weight: number;\r\n}","import createGraph from \"ngraph.graph\";\r\nimport MapData from \"../models/MapData\";\r\nimport { MapGraph, NodeData, VertexData } from \"../models/MapGraph\";\r\n\r\n/*\r\n  Convert the Map data DTO to an ngaph.graph object for pathfinding\r\n*/\r\nexport default class GraphBuilder {\r\n    public static Build(mapData: MapData): MapGraph {\r\n        let outGraph = createGraph<NodeData, VertexData>();\r\n\r\n        for (let i = 0; i < mapData.vertices.length; i++) {\r\n            const item = mapData.vertices[i];\r\n            outGraph.addNode(item.id, {\r\n                position: item.position,\r\n                clickRadius: item.clickRadius,\r\n                encounterId: item.encounterId,\r\n                exitId: item.exitId,\r\n            });\r\n        }\r\n\r\n        for (let i = 0; i < mapData.edges.length; i++) {\r\n            const item = mapData.edges[i];\r\n            outGraph.addLink(item.to, item.from, { weight: item.weight });\r\n        }\r\n\r\n        return new MapGraph(outGraph);\r\n    }\r\n}\r\n","\r\nexport default class Queue<T> {\r\n  _store: T[] = [];\r\n  push(val: T) {\r\n    this._store.push(val);\r\n  }\r\n  pop(): T | undefined {\r\n    return this._store.shift();\r\n  }\r\n  clear() {\r\n      this._store = [];\r\n  }\r\n}\r\n","import GameState from \"../models/GameState\";\r\n\r\nexport default class MockGameStateService {\r\n\r\n    private static _state: GameState = {\r\n        currentMapId: \"town\",\r\n        currentVertextId: \"scupperden-road\",\r\n    };\r\n\r\n    public getState(): GameState {\r\n        const stateJson = null; //localStorage.getItem(\"state\");\r\n        const state: GameState = stateJson ? JSON.parse(stateJson) : MockGameStateService._state;\r\n\r\n        return state;\r\n    }\r\n\r\n    public setState(state: GameState) {\r\n        MockGameStateService._state = state;\r\n        // localStorage.setItem(\"state\", JSON.stringify(state));\r\n    }\r\n}\r\n","import React, { useEffect, useState } from 'react';\r\n\r\n// UI Elements\r\nimport { CRS, Icon, latLng, LatLng, LatLngBounds } from \"leaflet\";\r\nimport { ImageOverlay, Map, Marker } from 'react-leaflet';\r\nimport DriftMarker from '../components/DriftMarker';\r\nimport EncounterDialog from \"../components/EncounterDialog\";\r\n\r\n// Services\r\nimport MockMapService from '../services/MockMapService';\r\n\r\n// Pathfinding imports\r\nimport npath from 'ngraph.path';\r\nimport GraphBuilder  from '../services/GraphBuilder';\r\nimport Queue from '../models/Queue';\r\nimport { Node } from \"ngraph.graph\";\r\nimport { useParams } from 'react-router-dom';\r\nimport MockGameStateService from '../services/MockGameStateService';\r\nimport GameState from '../models/GameState';\r\nimport { MapGraph, NodeData } from '../models/MapGraph';\r\n\r\ntype OverheadMapProps = {\r\n    // None\r\n};\r\n\r\nexport function OverheadMap(props: OverheadMapProps) {\r\n    \r\n    const params: any = useParams();\r\n    const mapId: string = params.id;\r\n\r\n    let [graph, setGraph] = useState(null as MapGraph | null); // The map graph data\r\n    let [pos, setPos] = useState(null as LatLng | null); // The current (target) position of the player marker\r\n    let [vertexQueue] = useState(new Queue<Node<NodeData>>()); // A queue of points to visit during path-finding\r\n    let [encounterId, setEncounterId] = useState(null as string | null);\r\n    let [mapUrl, setMapUrl] = useState(null as string | null);\r\n    let [userState, setUserState] = useState(null as GameState | null);\r\n    let [initialNode, setInitialNode] = useState(true); // Is it the first node arrived on a new map (So that we don't bounce between maps)\r\n\r\n    const setCurrentVertex = (vertexId: string) => {\r\n         if (!userState) return;\r\n\r\n        userState.currentVertextId = vertexId;\r\n        setUserState(userState);\r\n    }\r\n\r\n    // Fire when marker move has finished\r\n    const handleMoveEnd = (marker: any) => {\r\n        \r\n        console.log(\"Move ended\");\r\n\r\n        const targetVertex = vertexQueue.pop();\r\n        if (targetVertex) {\r\n            console.log(`Next vertex ${targetVertex.id}`);\r\n\r\n            setPos(targetVertex.data.position);\r\n\r\n            // Update user state\r\n            setCurrentVertex(targetVertex.id.toString());\r\n\r\n            //debugger;\r\n\r\n            // Activate exit if there is one, move to new map\r\n            if (targetVertex.data.exitId && !initialNode) {\r\n                console.log(`Set exit ${targetVertex.data.exitId}`);\r\n                const splits = targetVertex.data.exitId.split(\",\");\r\n                if (splits.length === 2) {\r\n                    const newState = {\r\n                        currentMapId: splits[0],\r\n                        currentVertextId: splits[1],\r\n                    } as GameState;\r\n                    const stateService = new MockGameStateService();\r\n\r\n                    setInitialNode(true);\r\n                    setPos(null);\r\n                    stateService.setState(newState);\r\n                    setUserState(newState);\r\n                    setGraph(null);\r\n                    setMapUrl(null);\r\n                }\r\n            }\r\n\r\n            // Activate encounter if there is one\r\n            if (targetVertex.data.encounterId) {\r\n                // console.log(`Set encounter ${targetEncounterId}`);\r\n                setEncounterId(targetVertex.data.encounterId);\r\n            }\r\n\r\n            setInitialNode(false);\r\n        }\r\n    };\r\n\r\n    // Fire when user clicks on the map\r\n    const handleClick = (e: any) => {\r\n        if (!graph || !userState) return; // Map not loaded\r\n\r\n        console.log(`clicked at: ${Math.round(e.latlng.lat)},${Math.round(e.latlng.lng)}`);\r\n\r\n        // Move to the nearest vertex to the clicked point\r\n        const match = graph.findNearestVertex(e.latlng);\r\n\r\n        if (match) {\r\n            console.log(`Clicked on vertex ${match.id}`);\r\n\r\n            var pathFinder = npath.aStar(graph.getNGraph());\r\n            let path = pathFinder.find(userState?.currentVertextId, match.id);\r\n\r\n            if (path.length <= 1) {\r\n                console.log(`No route found to ${match.id}`);\r\n                return;\r\n            }\r\n\r\n            path.pop(); // Remove the current/start node\r\n\r\n            vertexQueue.clear();\r\n            let nextVertex = path.pop();\r\n            while (nextVertex) {\r\n                vertexQueue.push(nextVertex);\r\n                // Stop if a vertex with an an encounter is hit\r\n                if (nextVertex.data.encounterId) {\r\n                    break;\r\n                }\r\n                nextVertex = path.pop();\r\n            }\r\n\r\n            handleMoveEnd(null); // Trigger the move to the next vertex\r\n        }\r\n    };\r\n\r\n    // Move to a vertex\r\n    const moveToVertexId = (mapGraph: MapGraph, vertexId: string) => {\r\n\r\n        if (!mapGraph) return;\r\n\r\n        const match = mapGraph.findVertex(vertexId);\r\n        if (match) {\r\n            vertexQueue.push(match);\r\n            handleMoveEnd(null);\r\n        } else {\r\n            console.error(`Can't find vertex ${vertexId}`);\r\n        }\r\n    };\r\n\r\n    // On encounter dialog closed\r\n    const handleEncounterClose = (moveTo: string | undefined) => {\r\n        console.log(\"Close encounter\");\r\n        setEncounterId(null);\r\n\r\n        if (moveTo && graph) {\r\n            moveToVertexId(graph, moveTo);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        // Initial load of map data\r\n        const loadMap = () => {\r\n            const stateService = new MockGameStateService();\r\n            const newUserState = stateService.getState();\r\n            if (!newUserState) {\r\n                console.error(`No user state data`);\r\n                return;\r\n            }\r\n\r\n            setUserState(newUserState);\r\n\r\n            const service = new MockMapService();\r\n            const data = service.getMap(newUserState.currentMapId);\r\n            if (!data) {\r\n                console.error(`No map data`);\r\n                return;\r\n            }\r\n\r\n            setMapUrl(data.imageUrl);\r\n\r\n            console.log(`Found ${data?.vertices.length} vertices`);\r\n            const mapGraph = GraphBuilder.Build(data);\r\n\r\n            const initialVertex = mapGraph.findVertex(newUserState.currentVertextId);\r\n            if (initialVertex) {\r\n                setPos(initialVertex?.data.position);\r\n            }\r\n\r\n            setGraph(mapGraph);\r\n\r\n            // Mpve to the initial node\r\n            moveToVertexId(mapGraph, newUserState.currentVertextId);\r\n        };\r\n\r\n        if (graph == null) {\r\n            loadMap();\r\n        }\r\n    });\r\n\r\n    const bounds = new LatLngBounds(latLng([0.0, 0.0]), latLng([3200, 4000]));\r\n    // const maxBounds = new LatLngBounds(latLng([-0.0002, 0.0]), latLng([0.01025, 0.012]));\r\n\r\n    var markerIcon = new Icon({\r\n        iconUrl: \"images/marker.png\",\r\n        iconSize: [50, 75],\r\n        iconAnchor: [25, 65],\r\n        // popupAnchor: [-3, -76],\r\n        // shadowUrl: 'my-icon-shadow.png',\r\n        // shadowSize: [68, 95],\r\n        // shadowAnchor: [22, 94]\r\n    });\r\n\r\n    const renderVertexMarkers = () => {\r\n        if (!graph) return null;\r\n        \r\n        const vertices = graph.getVertices();\r\n\r\n        // for (let i = 0; i < vertices.length; i++) {\r\n        //     const v = vertices[i];\r\n        //     console.log(`marker at ${v.data['position']} is ${v.id}`);\r\n        // }\r\n\r\n        return vertices.map((v) => {\r\n            const icon = new Icon({\r\n                iconUrl: \"images/blank.svg\",\r\n                iconSize: [50, 50],\r\n                className: v.data.exitId ? \"exit-icon\" : \"vertex-icon\",\r\n            });\r\n            return <Marker key={v.id} position={v.data.position} title={v.id.toString()} icon={icon} />\r\n        });\r\n    };\r\n\r\n    if (!userState || !mapUrl || !pos)\r\n        return null;\r\n\r\n    // maxBounds={bounds}\r\n    return (\r\n        <Map\r\n            crs={CRS.Simple}\r\n            zoom={-1}\r\n            minZoom={-1}\r\n            maxZoom={-1}\r\n            bounds={bounds}\r\n            maxBounds={bounds}\r\n            scrollWheelZoom={false}\r\n            onClick={handleClick}\r\n            zoomControl={false}\r\n        >\r\n            <EncounterDialog onClose={handleEncounterClose} encounterId={encounterId} />\r\n            {/* <TileLayer url=\"tiles/{z}/{x}/{y}.png\" bounds={bounds} /> */}\r\n            <ImageOverlay url={mapUrl} bounds={bounds} />\r\n            <DriftMarker duration={1000} position={pos} keepAtCenter={false} icon={markerIcon} onMoveEnd={handleMoveEnd} />\r\n            {renderVertexMarkers()}\r\n        </Map>\r\n    );\r\n}\r\n\r\nexport default OverheadMap;\r\n","import React from \"react\";\r\nimport { withStyles, makeStyles } from \"@material-ui/core/styles\";\r\nimport Table from \"@material-ui/core/Table\";\r\nimport TableBody from \"@material-ui/core/TableBody\";\r\nimport TableCell from \"@material-ui/core/TableCell\";\r\nimport TableContainer from \"@material-ui/core/TableContainer\";\r\nimport TableHead from \"@material-ui/core/TableHead\";\r\nimport TableRow from \"@material-ui/core/TableRow\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport AttributeList from \"../models/AttributeList\";\r\nimport Attribute from \"../models/Attribute\";\r\n\r\nconst StyledTableCell = withStyles((theme) => ({\r\n    head: {\r\n        fontFamily: \"Martel\",\r\n        backgroundColor: theme.palette.common.black,\r\n        color: theme.palette.common.white,\r\n    },\r\n    body: {\r\n        fontFamily: \"Martel\",\r\n        fontSize: 14,\r\n    },\r\n}))(TableCell);\r\n\r\nconst StyledTableRow = withStyles((theme) => ({\r\n    root: {\r\n        \"&:nth-of-type(odd)\": {\r\n            backgroundColor: theme.palette.action.hover,\r\n        },\r\n    },\r\n}))(TableRow);\r\n\r\nconst useStyles = makeStyles({\r\n    table: {\r\n        minWidth: 700,\r\n    },\r\n});\r\n\r\ntype StatisticsBlockProps = {\r\n    statistics: AttributeList\r\n};\r\n\r\nexport default function StatisticsBlock(props: StatisticsBlockProps) {\r\n    const classes = useStyles();\r\n\r\n    const { statistics } = props;\r\n\r\n    function createData(name: string, base: number, modifier: number, total: number) {\r\n        return { name, base, modifier, total };\r\n    }\r\n\r\n    const attributeTotal = (attribute: Attribute) => attribute.base + attribute.modifier;\r\n\r\n    const rows = [\r\n        createData(\"Strength\", statistics.strength.base, statistics.strength.modifier, attributeTotal(statistics.strength)),\r\n        createData(\"Dexterity\", statistics.dexterity.base, statistics.dexterity.modifier, attributeTotal(statistics.dexterity)),\r\n        createData(\"Consitution\", statistics.constitution.base, statistics.constitution.modifier, attributeTotal(statistics.constitution)),\r\n        createData(\"Intelligence\", statistics.intelligence.base, statistics.intelligence.modifier, attributeTotal(statistics.intelligence)),\r\n        createData(\"Wisdom\", statistics.wisdom.base, statistics.wisdom.modifier, attributeTotal(statistics.wisdom)),\r\n        createData(\"Charisma\", statistics.charisma.base, statistics.charisma.modifier, attributeTotal(statistics.charisma)),\r\n        createData(\"Luck\", statistics.strength.base, statistics.strength.modifier, attributeTotal(statistics.strength)),\r\n    ];\r\n\r\n    return (\r\n        <TableContainer component={Paper}>\r\n            <Table className={classes.table} aria-label=\"customized table\">\r\n                <TableHead>\r\n                    <TableRow>\r\n                        <StyledTableCell>Attribute</StyledTableCell>\r\n                        <StyledTableCell align=\"right\">Base</StyledTableCell>\r\n                        <StyledTableCell align=\"right\">Modifier</StyledTableCell>\r\n                        <StyledTableCell align=\"right\">Total</StyledTableCell>\r\n                    </TableRow>\r\n                </TableHead>\r\n                <TableBody>\r\n                    {rows.map((row) => (\r\n                        <StyledTableRow key={row.name}>\r\n                            <StyledTableCell component=\"th\" scope=\"row\">\r\n                                {row.name}\r\n                            </StyledTableCell>\r\n                            <StyledTableCell align=\"right\">{row.base}</StyledTableCell>\r\n                            <StyledTableCell align=\"right\">{row.modifier}</StyledTableCell>\r\n                            <StyledTableCell align=\"right\">{row.total}</StyledTableCell>\r\n                        </StyledTableRow>\r\n                    ))}\r\n                </TableBody>\r\n            </Table>\r\n        </TableContainer>\r\n    );\r\n}\r\n","import PartyStatistics from \"../models/PartyStatistics\";\r\n\r\nexport default class MockPartyService {\r\n    getParty(): PartyStatistics {\r\n        return {\r\n            reputation: 12,\r\n            traits: [\"Humiliated the Dread Pirate Roberts\", \"Gouged the eye from a Titan\"],\r\n        };\r\n    }\r\n}\r\n","import WorldStatistics from \"../models/WorldStatistics\";\r\n\r\nexport default class MockWorldService {\r\n    getWorld(): WorldStatistics {\r\n        return {\r\n            traits: [\r\n                \"Ruled by a militarstic uncaring God-King Sorcerer\",\r\n                \"A Democractic council controls the Docks\",\r\n                \"A powerful midget controls the theives guild\",\r\n            ],\r\n        };\r\n    }\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { makeStyles } from \"@material-ui/core\";\r\nimport StatisticsBlock from \"../components/StatisticsBlock\";\r\nimport MockHeroService from \"../services/MockHeroService\";\r\nimport Hero from \"../models/Hero\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport Trait from \"../models/Trait\";\r\nimport PartyStatistics from \"../models/PartyStatistics\";\r\nimport MockPartyService from \"../services/MockPartyService\";\r\nimport MockWorldService from \"../services/MockWorldService\";\r\nimport WorldStatistics from \"../models/WorldStatistics\";\r\n\r\nconst useStyles = makeStyles({\r\n    characterGrid: {\r\n        backgroundColor: \"beige\",\r\n        fontFamily: \"Martel\",\r\n        display: \"grid\",\r\n        gridTemplateColumns: \"repeat(2, 1fr)\",\r\n        gridAutoRows: \"minmax(100px, auto)\",\r\n        height: \"calc(100vh - 115px)\",\r\n    },\r\n    left: {},\r\n    sectionHeading: {\r\n        fontFamily: \"MedievalSharp\",\r\n    },\r\n    bannerContainer: {\r\n        position: \"relative\",\r\n        height: \"100px\",\r\n        top: \"-80px\",\r\n        zIndex: 1,\r\n    },\r\n    itemContainer: {\r\n        position: \"relative\",\r\n    },\r\n    close: {\r\n        position: \"absolute\",\r\n        left: \"20px\",\r\n        top: \"-100px\",\r\n        width: \"40px\",\r\n        filter: \"invert(42%) sepia(93%) saturate(1352%) hue-rotate(32deg) brightness(60%) contrast(119%)\",\r\n    },\r\n    portrait: {\r\n        backgroundColor: \"ivory\",\r\n        height: \"calc(60vh - 55px)\",\r\n        zIndex: 0,\r\n        border: \"solid\",\r\n        borderWidth: \"4px\",\r\n        borderColor: \"beige\",\r\n        borderRadius: \"20px\",\r\n    },\r\n    portraitImg: {\r\n        position: \"absolute\",\r\n        left: \"20%\",\r\n        width: \"40%\",\r\n        border: \"solid\",\r\n        borderRadius: \"50%\",\r\n        borderWidth: \"10px\",\r\n        borderColor: \"lightslategrey\",\r\n        margin: \"68px\",\r\n    },\r\n    portraitItem: {\r\n        position: \"absolute\",\r\n        width: \"70px\",\r\n        border: \"solid\",\r\n        borderRadius: \"50%\",\r\n        borderWidth: \"6px\",\r\n        borderColor: \"lightslategrey\",\r\n    },\r\n    portraitItemHelm: {\r\n        left: \"90px\",\r\n        top: \"35px\",\r\n    },\r\n    portraitItemBreastplate: {\r\n        left: \"90px\",\r\n        top: \"135px\",\r\n    },\r\n    portraitItemGloves: {\r\n        left: \"90px\",\r\n        top: \"235px\",\r\n    },\r\n    portraitItemLegs: {\r\n        left: \"90px\",\r\n        top: \"335px\",\r\n    },\r\n    inventory: {\r\n        height: \"calc(40vh - 80px)\",\r\n        backgroundColor: \"ivory\",\r\n        border: \"solid\",\r\n        borderWidth: \"4px\",\r\n        borderColor: \"beige\",\r\n        borderRadius: \"20px\",\r\n    },\r\n    inventoryGrid: {\r\n        border: \"5px solid rgb(111,41,97)\",\r\n        display: \"grid\",\r\n        gridTemplateColumns: \"repeat(6, 80px)\",\r\n        gridAutoRows: \"5em\",\r\n        inlineSize: \"500px\",\r\n        alignItems: \"center\",\r\n        margin: \"0 auto\",\r\n    },\r\n    statistics: {\r\n        overflowY: \"scroll\",\r\n        backgroundColor: \"ivory\",\r\n        gridRowEnd: \"span 2\",\r\n        border: \"solid\",\r\n        borderWidth: \"4px\",\r\n        borderColor: \"beige\",\r\n        borderRadius: \"20px\",\r\n    },\r\n    statisticsBlock: {\r\n        padding: \"40px 80px\",\r\n    },\r\n});\r\n\r\ntype HeroProfileProps = {\r\n    //id: string,\r\n};\r\n\r\nexport function HeroProfile(props: HeroProfileProps) {\r\n    const classes = useStyles();\r\n\r\n    const params: any = useParams();\r\n    const id = params.id;\r\n\r\n    let [hero, setHero] = useState(null as Hero | null);\r\n    let [party, setParty] = useState(null as PartyStatistics | null);\r\n    let [world, setWorld] = useState(null as WorldStatistics | null);\r\n    let [currentId, setCurrentId] = useState(-1);\r\n\r\n    useEffect(() => {\r\n        // Initial load of hero data\r\n        const loadHero = () => {\r\n            const service = new MockHeroService();\r\n            const newHero = service.getHeroDetail(id);\r\n\r\n            const partyService = new MockPartyService();\r\n            const newParty = partyService.getParty();\r\n\r\n            const worldService = new MockWorldService();\r\n            const newWorld = worldService.getWorld();\r\n\r\n            if (!newHero) {\r\n                console.error(`No hero data`);\r\n                return;\r\n            }\r\n            if (!newParty) {\r\n                console.error(`No party data`);\r\n                return;\r\n            }\r\n            if (!newWorld) {\r\n                console.error(`No world data`);\r\n                return;\r\n            }\r\n\r\n            console.log(\"Loading hero\");\r\n            setCurrentId(id);\r\n            setHero(newHero);\r\n            setParty(newParty);\r\n            setWorld(newWorld);\r\n        };\r\n\r\n        if (currentId !== id) {\r\n            loadHero();\r\n        }\r\n    });\r\n\r\n    if (!hero || !party || !world) return null;\r\n\r\n    const renderTrait = (t: Trait) => (\r\n        <p>\r\n            {t.name}: {t.from}, {t.behaviour}\r\n        </p>\r\n    );\r\n\r\n    return (\r\n        <div className={classes.characterGrid}>\r\n            <div className={classes.left}>\r\n                <div className={classes.portrait}>\r\n                    <br />\r\n                    <div className={classes.bannerContainer}>\r\n                        <h1 className=\"banner\">{hero.name}</h1>\r\n                    </div>\r\n                    <div className={classes.itemContainer}>\r\n                        <a href=\"/#/\">\r\n                            <img src=\"images/close.svg\" className={classes.close} alt=\"close\" />\r\n                        </a>\r\n                        <img src={hero.imageUrl} className={classes.portraitImg} alt=\"profile\" />\r\n                        <img src=\"images/helm.svg\" className={`${classes.portraitItem} ${classes.portraitItemHelm}`} alt=\"helm\" />\r\n                        <img\r\n                            src=\"images/breastplate.svg\"\r\n                            className={`${classes.portraitItem} ${classes.portraitItemBreastplate}`}\r\n                            alt=\"breastplate\"\r\n                        />\r\n                        <img src=\"images/leg.svg\" className={`${classes.portraitItem} ${classes.portraitItemLegs}`} alt=\"legs\" />\r\n                        <img src=\"images/glove.svg\" className={`${classes.portraitItem} ${classes.portraitItemGloves}`} alt=\"gloves\" />\r\n                    </div>\r\n                </div>\r\n                <div className={classes.inventory}>\r\n                    <br />\r\n                    <h1 className={classes.sectionHeading}>Party Inventory</h1>\r\n                    <div className={classes.inventoryGrid}>\r\n                        <div>1</div>\r\n                        <div>2</div>\r\n                        <div>3</div>\r\n                        <div>4</div>\r\n                        <div>5</div>\r\n                        <div>6</div>\r\n                        <div>7</div>\r\n                        <div>8</div>\r\n                        <div>9</div>\r\n                        <div>10</div>\r\n                        <div>11</div>\r\n                        <div>12</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className={classes.statistics}>\r\n                <br />\r\n                <br />\r\n                <h1 className={classes.sectionHeading}>Statistics</h1>\r\n                <div className={classes.statisticsBlock}>\r\n                    <StatisticsBlock statistics={hero.attributes} />\r\n                </div>\r\n                <h1 className={classes.sectionHeading}>Other</h1>\r\n                <div className={classes.statisticsBlock}>\r\n                    <p>Hit Points 10/16</p>\r\n                    <p>Initiative 2</p>\r\n                    <p>Spell Resistance Save 14</p>\r\n                    <p>Witch Taint 12</p>\r\n                </div>\r\n                <h1 className={classes.sectionHeading}>Skills</h1>\r\n                <div className={classes.statisticsBlock}>\r\n                    <p>Persuasion d10</p>\r\n                    <p>Religion d12</p>\r\n                </div>\r\n                <h1 className={classes.sectionHeading}>Traits</h1>\r\n                <div className={classes.statisticsBlock}>{hero.traits.map((t) => renderTrait(t))}</div>\r\n                <h1 className={classes.sectionHeading}>Party Standing</h1>\r\n                <div className={classes.statisticsBlock}>\r\n                    <p>Reputation {party.reputation}</p>\r\n                    {party.traits.map((t) => (\r\n                        <p>{t}</p>\r\n                    ))}\r\n                </div>\r\n                <h1 className={classes.sectionHeading}>Voormithadreth Status</h1>\r\n                <div className={classes.statisticsBlock}>\r\n                    {world.traits.map((t) => (\r\n                        <p>{t}</p>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default HeroProfile;\r\n","import React, { useEffect, useState } from 'react';\r\n\r\n// UI Elements\r\nimport { CRS, Icon, latLng, LatLngBounds } from 'leaflet';\r\nimport { Map, ImageOverlay, Polygon } from \"react-leaflet\";\r\nimport DriftMarker from '../components/DriftMarker';\r\nimport EncounterDialog from \"../components/EncounterDialog\";\r\n\r\n// Services\r\nimport MockDetailedEncounterService from \"../services/MockDetailedEncounterService\";\r\n\r\n// Pathfinding imports\r\nimport Queue from '../models/Queue';\r\nimport { Graph, Node } from \"ngraph.graph\";\r\n\r\ntype EncounterMapProps = {\r\n    // None\r\n};\r\n\r\nexport function EncounterMap(props: EncounterMapProps) {\r\n    // const pos = { lat: -51.505, lng: -0.09 } as any;\r\n    const initialPos = latLng([0, 0]);\r\n    const initialNode = \"common-room\";\r\n\r\n    let [pos, setPos] = useState(initialPos); // The current (target) position of the player marker\r\n    let [currentVertex, setCurrentVertex] = useState(initialNode); // The current vertex that the player marker is at\r\n    let [vertexQueue] = useState(new Queue<any>()); // A queue of points to visit during path-finding\r\n    let [encounterId, setEncounterId] = useState(null as string | null);\r\n\r\n    // Build verticies from the graph\r\n    // TODO: Is there an easier method to use?\r\n    const getVertices = (graph: Graph<any, any> | null): Node<any>[] => {\r\n        if (!graph) return [];\r\n\r\n        var vertices: Node<any>[] = [];\r\n        graph.forEachNode((n: Node<any>) => {\r\n            vertices.push(n);\r\n        });\r\n\r\n        return vertices;\r\n    };\r\n\r\n    // // Get the vertex nearest to the clicked point\r\n    // const findNearestVertex = (graph: Graph<any, any> | null, pos: LatLng): any => {\r\n    //     const vertices = getVertices(graph);\r\n\r\n    //     for (let i = 0; i < vertices.length; i++) {\r\n    //         const vertex = vertices[i];\r\n\r\n    //         const dist = distance(pos, vertex.data[\"position\"]);\r\n    //         const isInRadius = dist < vertex.data[\"clickRadius\"];\r\n\r\n    //         if (isInRadius) {\r\n    //             return vertex;\r\n    //         }\r\n    //         // console.log(`Distance to ${vertex.id} is (${dist} < ${vertex.clickRadius}) = ${isInRadius}`);\r\n    //     }\r\n\r\n    //     return null;\r\n    // };\r\n\r\n    // Fire when marker move has finished\r\n    const handleMoveEnd = (marker: any) => {\r\n        console.log(\"Move ended\");\r\n\r\n        var targetVertex = vertexQueue.pop();\r\n        if (targetVertex) {\r\n            console.log(`Next vertex ${targetVertex.id}`);\r\n\r\n            setPos(targetVertex.data[\"position\"]);\r\n            setCurrentVertex(targetVertex.id);\r\n\r\n            const targetEncounterId = targetVertex.data[\"encounterId\"];\r\n            if (targetEncounterId) {\r\n                // console.log(`Set encounter ${targetEncounterId}`);\r\n                setEncounterId(targetEncounterId);\r\n            }\r\n        }\r\n    };\r\n\r\n    // Fire when user clicks on the map\r\n    const handleClick = (e: any) => {\r\n        //if (!graph) return; // Map not loaded\r\n\r\n        console.log(\"clicked at: \" + e.latlng);\r\n    };\r\n\r\n    const handleEncounterClose = (moveTo: string | undefined) => {\r\n        console.log(\"Close encounter\");\r\n        setEncounterId(null);\r\n    };\r\n\r\n    useEffect(() => {\r\n        // Initial load of map data\r\n        // const loadMap = () => {\r\n        //     const service = new MockMapService();\r\n        //     const data = service.getMap(\"temple\");\r\n        //     if (!data) {\r\n        //         console.error(`No map data`);\r\n        //         return;\r\n        //     }\r\n        //     console.log(`Found ${data?.vertices.length} vertices`);\r\n        //     const graph = GraphBuilder.Build(data);\r\n        //     setGraph(graph);\r\n        // };\r\n        // if (graph == null) {\r\n        //     loadMap();\r\n        // }\r\n    });\r\n\r\n    //const bounds = new LatLngBounds(latLng([0.0, 0.0]), latLng([0.009634, 0.009642]));\r\n    const bounds = new LatLngBounds(latLng([0.0, 0.0]), latLng([1609, 2143]));\r\n    //const maxBounds = new LatLngBounds(latLng([-0.0002, 0.0]), latLng([0.01025, 0.012]));\r\n\r\n    // maxBounds={bounds}\r\n    return (\r\n        <Map\r\n            crs={CRS.Simple}\r\n            zoom={3}\r\n            minZoom={-5}\r\n            maxZoom={20}\r\n            bounds={bounds}\r\n            maxBounds={bounds}\r\n            scrollWheelZoom={false}\r\n            onClick={handleClick}\r\n            zoomControl={true}\r\n        >\r\n            <EncounterDialog onClose={handleEncounterClose} encounterId={encounterId} />\r\n            {/* <TileLayer url=\"tiles/Tavern/row-{x}-col-{y}.png\" bounds={bounds} /> */}\r\n            <ImageOverlay url=\"maps/tavern.png\" bounds={bounds} />\r\n        </Map>\r\n    );\r\n}\r\n\r\nexport default EncounterMap;\r\n","import { createMuiTheme } from \"@material-ui/core\";\r\nimport { blue } from \"@material-ui/core/colors\";\r\n\r\nconst PitTheme = createMuiTheme({\r\n    palette: {\r\n        primary: {\r\n            light: blue[500],\r\n            main: blue[500],\r\n            dark: blue[500],\r\n        },\r\n        secondary: {\r\n            light: blue[100],\r\n            main: blue[100],\r\n            dark: blue[100],\r\n        },\r\n        action: {\r\n            hover: blue[800],\r\n        },\r\n    },\r\n    overrides: {\r\n        MuiButton: {\r\n            root: {\r\n                \"&:hover\": {\r\n                    // backgroundColor: \"rgba(150, 150, 150, 0.25) !important\",\r\n                    color: \"white\",\r\n                },\r\n            },\r\n        },\r\n    },\r\n});\r\n\r\nexport default PitTheme;\r\n","import \"./App.scss\";\r\nimport { HashRouter, Route, Switch } from \"react-router-dom\";\r\n\r\nimport Header from \"./components/Header\";\r\nimport OverheadMap from \"./pages/OverheadMap\";\r\nimport HeroProfile from \"./pages/HeroProfile\";\r\nimport EncounterMap from \"./pages/EncounterMap\";\r\nimport React from \"react\";\r\nimport { ThemeProvider } from \"@material-ui/core\";\r\nimport PitTheme from \"./PitTheme\";\r\n\r\nfunction App() {\r\n\r\n    return (\r\n        <div className=\"app\">\r\n            <ThemeProvider theme={PitTheme}>\r\n                <Header />\r\n                <HashRouter>\r\n                    <Switch>\r\n                        <Route\r\n                            path=\"/profile/:id\"\r\n                            component={() => {\r\n                                return <HeroProfile />;\r\n                            }}\r\n                        />\r\n                        <Route path=\"/encounter\" component={EncounterMap} />\r\n                        <Route path=\"/:id\" component={OverheadMap} />\r\n                        <Route path=\"/\" component={OverheadMap} />\r\n                    </Switch>\r\n                </HashRouter>\r\n            </ThemeProvider>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}